<!-- profile.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Xinn Lab â€“ Profile</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<nav class="md-navbar">
  <div class="brand">Xinn Lab</div>
  <div class="md-nav-links">
    <a href="home.html">ğŸ </a>
    <a href="explore.html">ğŸ”</a>
    <a href="profile.html">ğŸ‘¤</a>
    <a href="chat.html">ğŸ’¬</a>
    <a href="settings.html">âš™ï¸</a>
  </div>
</nav>

  <h1>My Profile</h1>
  <div id="my-posts"></div>
  <button onclick="logout()">Logout</button>

  <script type="module">
    import { auth, db } from './js/firebase.js';
    import { query, where, getDocs, collection } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

    auth.onAuthStateChanged(async user => {
      if (!user) return location = 'index.html';

      const q = query(collection(db, 'posts'), where('uid', '==', user.uid));
      const snap = await getDocs(q);
      const box = document.getElementById('my-posts');

      snap.forEach(doc => {
        const p = doc.data();
        const div = document.createElement('div');
        div.className = 'post';
        div.innerHTML = `<img src="${p.imgURL}" /><p>${p.caption}</p>`;
        box.appendChild(div);
      });
    });

    function logout() {
      auth.signOut().then(() => location = 'index.html');
    }
  </script>
</body>
</html>
