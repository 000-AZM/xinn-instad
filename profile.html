<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Xinn Lab – Profile</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- Navbar -->
  <nav class="md-navbar">
    <div class="brand">Xinn Lab</div>
    <div class="md-nav-links">
      <a href="home.html">🏠</a>
      <a href="explore.html">🔍</a>
      <a href="profile.html">👤</a>
      <a href="chat.html">💬</a>
      <a href="settings.html">⚙️</a>
    </div>
  </nav>

  <div class="container">
    <img id="avatar" src="assets/default-avatar.png" alt="Avatar" style="width:100px;border-radius:50%;margin:20px auto;" />
    <h2 id="username">@user</h2>
    <p id="email"></p>
    <button onclick="editProfile()">✏️ Edit Profile</button>

    <h3 style="margin-top:30px;">My Posts</h3>
    <div id="my-posts" class="post-grid"></div>
  </div>

  <script type="module">
    import { auth, db } from './js/firebase.js';
    import { collection, query, where, onSnapshot } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js';

    auth.onAuthStateChanged(user => {
      if (!user) return location = 'index.html';
      document.getElementById('username').textContent = '@' + user.email.split('@')[0];
      document.getElementById('email').textContent = user.email;

      const q = query(collection(db, 'posts'), where('uid', '==', user.uid));
      onSnapshot(q, snapshot => {
        const container = document.getElementById('my-posts');
        container.innerHTML = '';
        snapshot.forEach(doc => {
          const post = doc.data();
          const div = document.createElement('div');
          div.className = 'post';
          div.innerHTML = `
            <img src="${post.imgURL}" />
            <p>${post.caption}</p>
          `;
          container.appendChild(div);
        });
      });
    });

    function editProfile() {
      alert('Edit profile coming soon!');
    }
  </script>
</body>
</html>
